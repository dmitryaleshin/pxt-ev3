!function r(s,o,n){function a(i,t){if(!o[i]){if(!s[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(h)return h(i,!0);t=new Error("Cannot find module '"+i+"'");throw t.code="MODULE_NOT_FOUND",t}e=o[i]={exports:{}};s[i][0].call(e.exports,function(t){var e=s[i][1][t];return a(e||t)},e,e.exports,r,s,o,n)}return o[i].exports}for(var h="function"==typeof require&&require,t=0;t<n.length;t++)a(n[t]);return a}({1:[function(t,e,i){var r=t("./TypedNeuQuant.js"),s=t("./LZWEncoder.js");function o(){this.page=-1,this.pages=[],this.newPage()}o.pageSize=4096,o.charMap={};for(var n=0;n<256;n++)o.charMap[n]=String.fromCharCode(n);function a(t,e){this.width=~~t,this.height=~~e,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.image=null,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.neuQuant=null,this.usedEntry=new Array,this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10,this.dither=!1,this.globalPalette=!1,this.out=new o}o.prototype.newPage=function(){this.pages[++this.page]=new Uint8Array(o.pageSize),this.cursor=0},o.prototype.getData=function(){for(var t="",e=0;e<this.pages.length;e++)for(var i=0;i<o.pageSize;i++)t+=o.charMap[this.pages[e][i]];return t},o.prototype.writeByte=function(t){this.cursor>=o.pageSize&&this.newPage(),this.pages[this.page][this.cursor++]=t},o.prototype.writeUTFBytes=function(t){for(var e=t.length,i=0;i<e;i++)this.writeByte(t.charCodeAt(i))},o.prototype.writeBytes=function(t,e,i){for(var r=i||t.length,s=e||0;s<r;s++)this.writeByte(t[s])},a.prototype.setDelay=function(t){this.delay=Math.round(t/10)},a.prototype.setFrameRate=function(t){this.delay=Math.round(100/t)},a.prototype.setDispose=function(t){0<=t&&(this.dispose=t)},a.prototype.setRepeat=function(t){this.repeat=t},a.prototype.setTransparent=function(t){this.transparent=t},a.prototype.addFrame=function(t){this.image=t,this.colorTab=this.globalPalette&&this.globalPalette.slice?this.globalPalette:null,this.getImagePixels(),this.analyzePixels(),!0===this.globalPalette&&(this.globalPalette=this.colorTab),this.firstFrame&&(this.writeLSD(),this.writePalette(),0<=this.repeat)&&this.writeNetscapeExt(),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.globalPalette||this.writePalette(),this.writePixels(),this.firstFrame=!1},a.prototype.finish=function(){this.out.writeByte(59)},a.prototype.setQuality=function(t){this.sample=t=t<1?1:t},a.prototype.setDither=function(t){this.dither=t=!0===t?"FloydSteinberg":t},a.prototype.setGlobalPalette=function(t){this.globalPalette=t},a.prototype.getGlobalPalette=function(){return this.globalPalette&&this.globalPalette.slice&&this.globalPalette.slice(0)||this.globalPalette},a.prototype.writeHeader=function(){this.out.writeUTFBytes("GIF89a")},a.prototype.analyzePixels=function(){this.colorTab||(this.neuQuant=new r(this.pixels,this.sample),this.neuQuant.buildColormap(),this.colorTab=this.neuQuant.getColormap()),this.dither?this.ditherPixels(this.dither.replace("-serpentine",""),null!==this.dither.match(/-serpentine/)):this.indexPixels(),this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent,!0))},a.prototype.indexPixels=function(t){for(var e=this.pixels.length/3,i=(this.indexedPixels=new Uint8Array(e),0),r=0;r<e;r++){var s=this.findClosestRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[s]=!0,this.indexedPixels[r]=s}},a.prototype.ditherPixels=function(t,e){var i={FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[.25,1,1]],FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]]};if(!t||!i[t])throw"Unknown dithering kernel: "+t;var r=i[t],s=this.height,o=this.width,n=this.pixels,a=e?-1:1;this.indexedPixels=new Uint8Array(this.pixels.length/3);for(var h=0;h<s;h++){e&&(a*=-1);for(var l=1==a?0:o-1,u=1==a?o:0;l!==u;l+=a){var p,f=n[P=3*(p=h*o+l)],c=n[1+P],y=n[2+P];P=this.findClosestRGB(f,c,y),this.usedEntry[P]=!0,this.indexedPixels[p]=P,P*=3;for(var w=f-this.colorTab[P],d=c-this.colorTab[1+P],g=y-this.colorTab[2+P],x=1==a?0:r.length-1,b=1==a?r.length:0;x!==b;x+=a){var v,P,m=r[x][1],B=r[x][2];0<=m+l&&m+l<o&&0<=B+h&&B+h<s&&(v=r[x][0],P=p+m+B*o,n[P*=3]=Math.max(0,Math.min(255,n[P]+w*v)),n[1+P]=Math.max(0,Math.min(255,n[1+P]+d*v)),n[2+P]=Math.max(0,Math.min(255,n[2+P]+g*v)))}}}},a.prototype.findClosest=function(t,e){return this.findClosestRGB((16711680&t)>>16,(65280&t)>>8,255&t,e)},a.prototype.findClosestRGB=function(t,e,i,r){if(null===this.colorTab)return-1;if(this.neuQuant&&!r)return this.neuQuant.lookupRGB(t,e,i);for(var s=0,o=16777216,n=this.colorTab.length,a=0,h=0;a<n;h++){var l=t-(255&this.colorTab[a++]),u=e-(255&this.colorTab[a++]),p=i-(255&this.colorTab[a++]),l=l*l+u*u+p*p;(!r||this.usedEntry[h])&&l<o&&(o=l,s=h)}return s},a.prototype.getImagePixels=function(){for(var t=this.width,e=this.height,i=(this.pixels=new Uint8Array(t*e*3),this.image),r=0,s=0,o=0;o<e;o++)for(var n=0;n<t;n++)this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],this.pixels[s++]=i[r++],r++},a.prototype.writeGraphicCtrlExt=function(){var t,e;this.out.writeByte(33),this.out.writeByte(249),this.out.writeByte(4),e=null===this.transparent?t=0:(t=1,2),0<=this.dispose&&(e=7&dispose),this.out.writeByte(0|(e<<=2)|t),this.writeShort(this.delay),this.out.writeByte(this.transIndex),this.out.writeByte(0)},a.prototype.writeImageDesc=function(){this.out.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame||this.globalPalette?this.out.writeByte(0):this.out.writeByte(128|this.palSize)},a.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.out.writeByte(240|this.palSize),this.out.writeByte(0),this.out.writeByte(0)},a.prototype.writeNetscapeExt=function(){this.out.writeByte(33),this.out.writeByte(255),this.out.writeByte(11),this.out.writeUTFBytes("NETSCAPE2.0"),this.out.writeByte(3),this.out.writeByte(1),this.writeShort(this.repeat),this.out.writeByte(0)},a.prototype.writePalette=function(){this.out.writeBytes(this.colorTab);for(var t=768-this.colorTab.length,e=0;e<t;e++)this.out.writeByte(0)},a.prototype.writeShort=function(t){this.out.writeByte(255&t),this.out.writeByte(t>>8&255)},a.prototype.writePixels=function(){new s(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this.out)},a.prototype.stream=function(){return this.out},e.exports=a},{"./LZWEncoder.js":2,"./TypedNeuQuant.js":3}],2:[function(t,e,i){var S=5003,T=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=function(e,i,t,r){var s,h,l,u,p,f,o=Math.max(2,r),n=new Uint8Array(256),c=new Int32Array(S),y=new Int32Array(S),a=0,w=0,d=!1;function g(t,e){n[h++]=t,254<=h&&v(e)}function x(t){for(var e=0;e<t;++e)c[e]=-1}function b(t,e){var i,r,s,o,n,a;for(d=!1,n_bits=u=t,l=P(n_bits),f=(p=1<<t-1)+1,w=p+2,h=0,s=m(),n=0,i=S;i<65536;i*=2)++n;n=8-n,x(5003),B(p,e);t:for(;-1!=(a=m());)if(c[r=a<<n^s]===(i=(a<<12)+s))s=y[r];else{if(0<=c[r]){o=5003-r,0===r&&(o=1);do{if((r-=o)<0&&(r+=5003),c[r]===i){s=y[r];continue t}}while(0<=c[r])}B(s,e),s=a,w<4096?(y[r]=w++,c[r]=i):(a=e,x(S),w=p+2,d=!0,B(p,a))}B(s,e),B(f,e)}function v(t){0<h&&(t.writeByte(h),t.writeBytes(n,0,h),h=0)}function P(t){return(1<<t)-1}function m(){return 0===remaining?-1:(--remaining,255&t[curPixel++])}function B(t,e){for(s&=T[a],0<a?s|=t<<a:s=t,a+=n_bits;8<=a;)g(255&s,e),s>>=8,a-=8;if((l<w||d)&&(d?(l=P(n_bits=u),d=!1):(++n_bits,l=12==n_bits?4096:P(n_bits))),t==f){for(;0<a;)g(255&s,e),s>>=8,a-=8;v(e)}}this.encode=function(t){t.writeByte(o),remaining=e*i,curPixel=0,b(o+1,t),t.writeByte(0)}}},{}],3:[function(t,e,i){var z=256,U=1<<18;e.exports=function(C,A){var E,p,I,D,G;function f(){var t,e,i,r,s=C.length,o=30+(A-1)/3,n=s/(3*A),a=~~(n/100),h=1024,l=2048,u=l>>6;for(u<=1&&(u=0),w=0;w<u;w++)G[w]=h*(256*(u*u-w*w)/(u*u));for(var p,f,c=s<1509?(A=1,3):s%499!=0?1497:s%491!=0?1473:s%487!=0?1461:1509,y=0,w=0;w<n;){if(t=(255&C[y])<<4,e=(255&C[y+1])<<4,i=(255&C[y+2])<<4,r=function(t,e,i){for(var r,s=~(1<<31),o=s,n=-1,a=n,h=0;h<z;h++)r=E[h],(r=Math.abs(r[0]-t)+Math.abs(r[1]-e)+Math.abs(r[2]-i))<s&&(s=r,n=h),(r=r-(I[h]>>12))<o&&(o=r,a=h),r=D[h]>>10,D[h]-=r,I[h]+=r<<10;return D[n]+=64,I[n]-=65536,a}(t,e,i),b=h,x=e,f=i,E[p=r][0]-=b*(E[p][0]-t)/1024,E[p][1]-=b*(E[p][1]-x)/1024,E[p][2]-=b*(E[p][2]-f)/1024,0!==u){g=d=M=F=T=S=B=m=P=v=b=x=void 0;for(var d,g,x=u,b=r,v=t,P=e,m=i,B=Math.abs(b-x),S=Math.min(b+x,z),T=b+1,F=b-1,M=1;T<S||B<F;)g=G[M++],T<S&&((d=E[T++])[0]-=g*(d[0]-v)/U,d[1]-=g*(d[1]-P)/U,d[2]-=g*(d[2]-m)/U),B<F&&((d=E[F--])[0]-=g*(d[0]-v)/U,d[1]-=g*(d[1]-P)/U,d[2]-=g*(d[2]-m)/U)}if(s<=(y+=c)&&(y-=s),++w%(a=0===a?1:a)==0)for(h-=h/o,(u=(l-=l/30)>>6)<=1&&(u=0),r=0;r<u;r++)G[r]=h*(256*(u*u-r*r)/(u*u))}}this.buildColormap=function(){var t,e;for(E=[],p=new Int32Array(256),I=new Int32Array(z),D=new Int32Array(z),G=new Int32Array(32),t=0;t<z;t++)e=(t<<12)/z,E[t]=new Float64Array([e,e,e,0]),D[t]=256,I[t]=0;f();for(var i=0;i<z;i++)E[i][0]>>=4,E[i][1]>>=4,E[i][2]>>=4,E[i][3]=i;for(var r,s,o,n,a,h=0,l=0,u=0;u<z;u++){for(a=(s=E[n=u])[1],r=u+1;r<z;r++)(o=E[r])[1]<a&&(n=r,a=o[1]);if(o=E[n],u!=n&&(r=o[0],o[0]=s[0],s[0]=r,r=o[1],o[1]=s[1],s[1]=r,r=o[2],o[2]=s[2],s[2]=r,r=o[3],o[3]=s[3],s[3]=r),a!=h){for(p[h]=l+u>>1,r=h+1;r<a;r++)p[r]=u;h=a,l=u}}for(p[h]=l+255>>1,r=h+1;r<256;r++)p[r]=255},this.getColormap=function(){for(var t=[],e=[],i=0;i<z;i++)e[E[i][3]]=i;for(var r=0,s=0;s<z;s++){var o=e[s];t[r++]=E[o][0],t[r++]=E[o][1],t[r++]=E[o][2]}return t},this.lookupRGB=function(t,e,i){for(var r,s,o,n=1e3,a=-1,h=p[e],l=h-1;h<z||0<=l;)h<z&&(n<=(o=(s=E[h])[1]-e)?h=z:(h++,o<0&&(o=-o),(o+=r=(r=s[0]-t)<0?-r:r)<n&&(o+=r=(r=s[2]-i)<0?-r:r)<n&&(n=o,a=s[3]))),0<=l&&(n<=(o=e-(s=E[l])[1])?l=-1:(l--,o<0&&(o=-o),(o+=r=(r=s[0]-t)<0?-r:r)<n&&(o+=r=(r=s[2]-i)<0?-r:r)<n&&(n=o,a=s[3])));return a}}},{}],4:[function(t,e,i){var r=t("./GIFEncoder.js"),s=function(s){var o,t=new r(s.width,s.height);return 0===s.index?t.writeHeader():t.firstFrame=!1,t.setTransparent(s.transparent),t.setRepeat(s.repeat),t.setDelay(s.delay),t.setQuality(s.quality),t.setDither(s.dither),t.setGlobalPalette(s.globalPalette),t.addFrame(s.data),s.last&&t.finish(),!0===s.globalPalette&&(s.globalPalette=t.getGlobalPalette()),t=t.stream(),s.data=t.pages,s.cursor=t.cursor,s.pageSize=t.constructor.pageSize,s.canTransfer?(t=function(){for(var t=s.data,e=[],i=0,r=t.length;i<r;i++)o=t[i],e.push(o.buffer);return e}(),self.postMessage(s,t)):self.postMessage(s)};self.onmessage=function(t){return s(t.data)}},{"./GIFEncoder.js":1}]},{},[4]);