!function i(l,r,s){function n(e,t){if(!r[e]){if(!l[e]){var o="function"==typeof require&&require;if(!t&&o)return o(e,!0);if(a)return a(e,!0);throw(t=new Error("Cannot find module '"+e+"'")).code="MODULE_NOT_FOUND",t}o=r[e]={exports:{}},l[e][0].call(o.exports,function(t){return n(l[e][1][t]||t)},o,o.exports,i,l,r,s)}return r[e].exports}for(var a="function"==typeof require&&require,t=0;t<s.length;t++)n(s[t]);return n}({1:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});const i=t("./field_ports"),l=t("./field_motors"),r=t("./field_brickbuttons"),s=t("./field_color"),n=t("./field_music");pxt.editor.initFieldExtensionsAsync=function(t){pxt.debug("loading pxt-ev3 target extensions..."),Blockly.BlockSvg.CORNER_RADIUS=0*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.STATEMENT_INPUT_INNER_SPACE=3*Blockly.BlockSvg.GRID_UNIT,Blockly.BlockSvg.NOTCH_PATH_LEFT="l 8,8 h 16 l 8,-8 ",Blockly.BlockSvg.NOTCH_PATH_RIGHT="l -8,8 h -16 l -8,-8 ",Blockly.BlockSvg.TOP_LEFT_CORNER_START="m 0,0",Blockly.BlockSvg.TOP_LEFT_CORNER="l "+Blockly.BlockSvg.CORNER_RADIUS+",0 ",Blockly.BlockSvg.TOP_RIGHT_CORNER="l 0,"+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.BOTTOM_RIGHT_CORNER="l 0,"+Blockly.BlockSvg.CORNER_RADIUS,Blockly.BlockSvg.BOTTOM_LEFT_CORNER="l -"+Blockly.BlockSvg.CORNER_RADIUS+",0",Blockly.BlockSvg.INNER_TOP_LEFT_CORNER="l "+Blockly.BlockSvg.CORNER_RADIUS+",-0",Blockly.BlockSvg.INNER_BOTTOM_LEFT_CORNER="l 0,"+2*Blockly.BlockSvg.CORNER_RADIUS+"l "+Blockly.BlockSvg.CORNER_RADIUS+",0",Blockly.Flyout.prototype.CORNER_RADIUS=0,Blockly.Flyout.prototype.MARGIN=8;var e={fieldEditors:[{selector:"ports",editor:i.FieldPorts},{selector:"motors",editor:l.FieldMotors},{selector:"brickbuttons",editor:r.FieldBrickButtons},{selector:"colorenum",editor:s.FieldColorEnum},{selector:"music",editor:n.FieldMusic}]};return Promise.resolve(e)}},{"./field_brickbuttons":2,"./field_color":3,"./field_motors":4,"./field_music":5,"./field_ports":6}],2:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.FieldBrickButtons=void 0;class i extends Blockly.FieldDropdown{constructor(t,e,o){super(e.data),this.isFieldCustom_=!0,this.buttonClick_=function(t){t=t.target.getAttribute("data-value");this.setValue(t),Blockly.DropDownDiv.hide()},this.onHide_=function(){var t=Blockly.DropDownDiv.getContentDiv(),t=(t.removeAttribute("role"),t.removeAttribute("aria-haspopup"),t.removeAttribute("aria-activedescendant"),t.style.width="",this.sourceBlock_);null!=t&&t.isShadow()?t.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)},this.columns_=parseInt(e.columns)||4,this.width_=parseInt(e.width)||150}showEditor_(){if(!Blockly.DropDownDiv.hideIfOwner(this)){Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent();var t=Blockly.DropDownDiv.getContentDiv(),e=document.createElement("div"),o=(e.setAttribute("role","menu"),e.setAttribute("aria-haspopup","true"),document.createElementNS("http://www.w3.org/2000/svg","svg")),o=(pxsim.svg.hydrate(o,{viewBox:"0 0 256.68237 256.68237",width:this.width_,height:this.width_}),e.appendChild(o),pxsim.svg.child(o,"g",{transform:"translate(-4.695057,58.29823)"})),o=pxsim.svg.child(o,"g",{transform:"translate(3.9780427e-6,-32.677281)"}),i=(pxsim.svg.child(o,"path",{style:"fill:#6a6a6a;stroke-width:3.91719985",d:"M 106.30882,198.38022 C 84.431262,177.26258 50.453467,142.52878 50.453467,142.52878 v -7.12931 H 37.087971 a 32.381533,32.381533 0 1 1 0,-64.763062 H 50.457376 V 63.503186 L 105.71731,7.0563355 h 55.25604 c 25.02699,25.5048885 55.25994,55.2599395 55.25994,55.2599395 v 8.320133 h 12.77398 a 32.381533,32.381533 0 0 1 0,64.763062 h -12.77398 v 7.13323 c -29.43384,30.27603 -54.66454,55.85144 -54.66454,55.85144 z"}),pxsim.svg.child(o,"path",{style:"fill:#a8a9a8;stroke-width:3.91719985",d:"m 36.492567,78.357208 h 40.69971 V 126.48393 H 36.492567 A 24.063359,24.063359 0 0 1 12.429199,102.42057 v 0 A 24.063359,24.063359 0 0 1 36.492567,78.357208 Z"})),l=pxsim.svg.child(o,"path",{style:"fill:#a8a9a8;stroke-width:3.91719985",d:"M 229.00727,126.48784 H 188.30756 V 78.361126 h 40.69971 a 24.063359,24.063359 0 0 1 24.06335,24.063354 v 0 a 24.063359,24.063359 0 0 1 -24.06335,24.06336 z"}),r=[pxsim.svg.child(o,"path",{style:"fill:#3c3c3c;stroke-width:3.91719985",d:"m 109.27806,78.357208 h 46.9398 a 1.782326,1.782326 0 0 1 1.78233,1.782326 V 124.7016 a 1.782326,1.782326 0 0 1 -1.78233,1.78233 h -46.9398 a 1.782326,1.782326 0 0 1 -1.78233,-1.78233 V 80.139534 a 1.782326,1.782326 0 0 1 1.78233,-1.782326 z"}),i,l,pxsim.svg.child(o,"path",{style:"fill:#a8a9a8;stroke-width:3.91719985",d:"m 108.09114,15.967966 49.90905,-0.59542 37.43276,38.619675 -15.44943,15.449437 V 97.367379 H 165.7249 V 81.306861 A 11.978797,11.978797 0 0 0 153.84012,69.422075 c -11.59883,-0.184102 -43.37516,0 -43.37516,0 A 9.6676495,9.6676495 0 0 0 100.36251,79.520618 V 97.347793 H 86.103905 V 69.422075 L 70.654464,53.97264 Z"}),pxsim.svg.child(o,"path",{style:"fill:#a8a9a8;stroke-width:3.91719985",d:"M 157.78865,189.01028 108.18908,189.38233 70.654464,150.794 86.323259,135.4895 v -28.08625 h 14.101921 v 16.11144 a 12.006218,12.006218 0 0 0 11.85346,11.9788 c 11.59882,0.1841 43.13227,0 43.13227,0 a 10.18472,10.18472 0 0 0 10.38059,-10.38058 v -17.70966 h 14.39179 v 28.08632 l 15.3045,15.3045 z"})],s=this.getOptions();for(let t=0;s[t];t++){var n=s[t][0],a=s[t][1],c=r[t];c.setAttribute("id",":"+t),c.setAttribute("role","menuitem"),c.setAttribute("cursor","pointer"),pxsim.svg.child(c,"title").textContent=n,Blockly.bindEvent_(c,"click",this,this.buttonClick_),Blockly.bindEvent_(c,"mouseup",this,this.buttonClick_),Blockly.bindEvent_(c,"mousedown",c,function(t){this.setAttribute("stroke","#ffffff"),t.preventDefault()}),Blockly.bindEvent_(c,"mouseover",c,function(){this.setAttribute("stroke","#ffffff")}),Blockly.bindEvent_(c,"mouseout",c,function(){this.setAttribute("stroke","transparent")}),c.setAttribute("data-value",a)}e.style.width=this.width_+"px",t.appendChild(e),Blockly.DropDownDiv.setColour("#ffffff","#dddddd"),Blockly.DropDownDiv.showPositionedByField(this,this.onHide_.bind(this));i=this.sourceBlock_;this.savedPrimary_=null==i?void 0:i.getColour(),null!=i&&i.isShadow()?i.setColour(i.getColourTertiary()):this.borderRect_&&this.borderRect_.setAttribute("fill",this.sourceBlock_.getColourTertiary())}}}o.FieldBrickButtons=i},{}],3:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.FieldColorEnum=void 0;class i extends pxtblockly.FieldColorNumber{constructor(t,e,o){super(t,e,o),this.isFieldCustom_=!0,this.paramsData=e.data}mapColour(t){switch(t){case"#000000":return"ColorSensorColor.Black";case"#006db3":return"ColorSensorColor.Blue";case"#00934b":return"ColorSensorColor.Green";case"#ffd01b":return"ColorSensorColor.Yellow";case"#f12a21":return"ColorSensorColor.Red";case"#ffffff":return"ColorSensorColor.White";case"#6c2d00":return"ColorSensorColor.Brown";default:return"ColorSensorColor.None"}}mapEnum(t){switch(t){case"ColorSensorColor.Black":return"#000000";case"ColorSensorColor.Blue":return"#006db3";case"ColorSensorColor.Green":return"#00934b";case"ColorSensorColor.Yellow":return"#ffd01b";case"ColorSensorColor.Red":return"#f12a21";case"ColorSensorColor.White":return"#ffffff";case"ColorSensorColor.Brown":return"#6c2d00";case"ColorSensorColor.None":return"#dfe6e9";default:return t}}showEditor_(){super.showEditor_(),document.querySelectorAll(".legoColorPicker td").forEach(t=>{const e=this.mapColour(t.getAttribute("title"));var o=this.paramsData.findIndex(t=>t[1]===e);t.setAttribute("title",this.paramsData[o][0])})}getValue(t){var e=this.mapColour(this.value_);return!t&&-1<e.indexOf("#")?"0x"+e.replace(/^#/,""):e}setValue(t){t=this.mapEnum(t);this.sourceBlock_&&Blockly.Events.isEnabled()&&this.value_!=t&&Blockly.Events.fire(new Blockly.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,t)),this.value_=t,this.sourceBlock_&&this.sourceBlock_.setColour(t)}}o.FieldColorEnum=i},{}],4:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.FieldMotors=void 0;class i extends pxtblockly.FieldImages{constructor(t,e,o){super(t,e,o),this.isFieldCustom_=!0,this.buttonClick_=function(t){t=t.target.getAttribute("data-value");this.setValue(t),Blockly.DropDownDiv.hide()},this.columns_=parseInt(e.columns)||4,this.width_=parseInt(e.width)||400,this.addLabel_=!0,this.renderSelectedImage_=Blockly.FieldDropdown.prototype.renderSelectedText_,this.updateSize_=Blockly.Field.prototype.updateSize_}showEditor_(){if(!Blockly.DropDownDiv.hideIfOwner(this)){var i=this.sourceBlock_,t=(Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent(),Blockly.DropDownDiv.getContentDiv());let o=document.createElement("div");o.setAttribute("role","menu"),o.setAttribute("aria-haspopup","true");var l=this.getOptions();for(let e=0;e<l.length;e++){var r=l[e][0],s=l[e][1];if("placeholder"==r.type){var n=document.createElement("span");n.setAttribute("class","blocklyDropDownPlaceholder"),n.style.width=r.width+"px",n.style.height=r.height+"px",o.appendChild(n)}else{n=document.createElement("button");n.setAttribute("id",":"+e),n.setAttribute("role","menuitem"),n.setAttribute("class","blocklyDropDownButton"),n.title=r.alt,this.columns_?n.style.width=this.width_/this.columns_-8+"px":(n.style.width=r.width+"px",n.style.height=r.height+"px");let t=i.getColour();s==this.getValue()&&(t=i.getColourTertiary(),n.setAttribute("aria-selected","true")),n.style.backgroundColor=t,n.style.borderColor=i.getColourTertiary(),Blockly.bindEvent_(n,"click",this,this.buttonClick_),Blockly.bindEvent_(n,"mouseover",n,function(){this.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),o.setAttribute("aria-activedescendant",this.id)}),Blockly.bindEvent_(n,"mouseout",n,function(){this.setAttribute("class","blocklyDropDownButton"),o.removeAttribute("aria-activedescendant")});var a=document.createElement("img");a.src=r.src,n.setAttribute("data-value",s),a.setAttribute("data-value",s),n.appendChild(a),this.addLabel_&&((a=this.createTextNode_(r.alt)).setAttribute("data-value",s),a.style.whiteSpace="inherit",a.style.width="auto",a.style.padding="0 10px",n.appendChild(a)),o.appendChild(n)}}o.style.width=this.width_+"px",t.appendChild(o),Blockly.DropDownDiv.setColour(i.getColour(),i.getColourTertiary()),Blockly.DropDownDiv.showPositionedByField(this,this.onHideCallback.bind(this)),this.savedPrimary_=null==i?void 0:i.getColour(),null!=i&&i.isShadow()?i.setColour(i.style.colourTertiary):this.borderRect_&&this.borderRect_.setAttribute("fill",i.style.colourTertiary)}}trimOptions_(){}}o.FieldMotors=i},{}],5:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.FieldMusic=void 0;let i,l,r;class s extends pxtblockly.FieldImages{constructor(t,e,o){super(t,{blocksInfo:e.blocksInfo,sort:!0,data:e.data},o),this.isFieldCustom_=!0,this.buttonClick_=function(t){t=t.target.getAttribute("data-value");this.setValue(t),Blockly.DropDownDiv.hide()},this.categoryClick_=function(t){var t=t.target.getAttribute("data-value"),t=(this.setSelectedCategory(t),this.getOptions()),e=(t.sort(),this.getCategories(t)),o=Blockly.DropDownDiv.getContentDiv(),i=o.childNodes[0],o=o.childNodes[1];i.innerHTML="",o.innerHTML="",this.refreshCategories(i,e),this.refreshOptions(o,t),this.stopSounds()},this.buttonEnter_=function(t){i&&(t=t.substring(t.lastIndexOf(".")+1),t=i[t])&&(t={data:pxt.U.stringToUint8Array(atob(t))},pxsim.AudioContextManager.playBufferAsync(t))},this.buttonLeave_=function(){this.stopSounds()},this.columns_=parseInt(e.columns)||4,this.width_=parseInt(e.width)||450,this.setText=Blockly.FieldDropdown.prototype.setText,this.updateSize_=Blockly.Field.prototype.updateSize_,pxt.BrowserUtils.isIE()||(i=i||JSON.parse(pxtTargetBundle.bundledpkgs.music["sounds.jres"])),l||(l=JSON.parse(pxtTargetBundle.bundledpkgs.music["icons.jres"]),r=Object.entries(l).filter(t=>"*"!==t[0]))}showEditor_(){var t,e,o,i,l;Blockly.DropDownDiv.hideIfOwner(this)||(Blockly.DropDownDiv.hideWithoutAnimation(),Blockly.DropDownDiv.clearContent(),t=Blockly.DropDownDiv.getContentDiv(),(e=document.createElement("div")).setAttribute("role","menu"),e.setAttribute("aria-haspopup","true"),e.className="blocklyMusicFieldOptions",e.style.display="flex",e.style.flexWrap="wrap",e.style.float="none",o=this.getOptions(),l=this.getCategories(o),i=this.parseCategory(this.getText()),this.selectedCategory_=i||l[0],(i=document.createElement("div")).setAttribute("role","menu"),i.setAttribute("aria-haspopup","true"),i.style.backgroundColor=this.sourceBlock_.getColourTertiary(),i.className="blocklyMusicFieldCategories",this.refreshCategories(i,l),this.refreshOptions(e,o),e.style.width=this.width_+"px",e.style.cssFloat="left",t.style.maxHeight="410px",t.appendChild(i),t.appendChild(e),Blockly.DropDownDiv.setColour(this.sourceBlock_.getColour(),this.sourceBlock_.getColourTertiary()),Blockly.DropDownDiv.showPositionedByField(this,this.onHide_.bind(this)),l=this.sourceBlock_,this.savedPrimary_=null==l?void 0:l.getColour(),null!=l&&l.isShadow()?l.setColour(l.getColourTertiary()):this.borderRect_&&this.borderRect_.setAttribute("fill",this.sourceBlock_.getColourTertiary()))}getCategories(e){if(!this.categoriesCache_){var o={};for(let t=0;e[t];t++){var i=e[t][0];o[this.parseCategory(i)]=!0}this.categoriesCache_=Object.keys(o)}return this.categoriesCache_}refreshCategories(o,i){for(let e=0;e<i.length;e++){var l=i[e],r=document.createElement("button");r.setAttribute("id",":"+e),r.setAttribute("role","menuitem"),r.setAttribute("class","blocklyDropdownTag"),r.setAttribute("data-value",l);let t="#1A9DBC";l==this.selectedCategory_&&(t="#0c4e5e",r.setAttribute("aria-selected","true")),r.style.padding="2px 6px",r.style.backgroundColor=t,r.style.borderColor=t,Blockly.bindEvent_(r,"click",this,this.categoryClick_),Blockly.bindEvent_(r,"mouseup",this,this.categoryClick_);var s=this.createTextNode_(l);s.setAttribute("data-value",l),r.appendChild(s),o.appendChild(r)}}refreshOptions(i,t){var l=this.getCategories(t);for(let o=0;t[o];o++){var r=t[o][0];const c=t[o][1];var s=this.parseCategory(r);if(this.selectedCategory_==s)if("placeholder"==r.type){var n=document.createElement("span");n.setAttribute("class","blocklyDropDownPlaceholder"),n.style.width=r.width+"px",n.style.height=r.height+"px",i.appendChild(n)}else{n=document.createElement("button");n.setAttribute("id",":"+o),n.setAttribute("role","menuitem"),n.setAttribute("class","blocklyDropDownButton"),n.title=r,this.columns_?n.style.width=this.width_/this.columns_-8+"px":(n.style.width=r.width+"px",n.style.height=r.height+"px");let t=this.savedPrimary_||this.sourceBlock_.getColour(),e=(c==this.getValue()&&(t=this.sourceBlock_.getColourTertiary(),n.setAttribute("aria-selected","true")),n.style.backgroundColor=t,n.style.borderColor=this.sourceBlock_.getColourTertiary(),Blockly.bindEvent_(n,"click",this,this.buttonClick_),Blockly.bindEvent_(n,"mouseup",this,this.buttonClick_),this);Blockly.bindEvent_(n,"mousedown",n,function(t){this.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),t.preventDefault()}),Blockly.bindEvent_(n,"mouseenter",n,function(){e.buttonEnter_(c)}),Blockly.bindEvent_(n,"mouseleave",n,function(){e.buttonLeave_()}),Blockly.bindEvent_(n,"mouseover",n,function(){this.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),i.setAttribute("aria-activedescendant",this.id)}),Blockly.bindEvent_(n,"mouseout",n,function(){this.setAttribute("class","blocklyDropDownButton"),i.removeAttribute("aria-activedescendant")});var s=l.indexOf(s),a=document.createElement("img"),s=(a.src=this.getSoundIcon(s),this.createTextNode_(r));n.setAttribute("data-value",c),a.setAttribute("data-value",c),a.style.height="auto",s.setAttribute("data-value",c),"en"!==pxt.Util.userLanguage()&&s.setAttribute("lang",pxt.Util.userLanguage()),s.style.display="block",s.style.lineHeight="1rem",s.style.marginBottom="5%",s.style.padding="0px 8px",s.style.wordBreak="break-word",s.style.hyphens="auto",n.appendChild(a),n.appendChild(s),i.appendChild(n)}}}trimOptions_(){}onHide_(){super.onHide_(),Blockly.DropDownDiv.getContentDiv().style.maxHeight="",this.stopSounds();var t=this.sourceBlock_;null!=t&&t.isShadow()?t.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}createTextNode_(t){this.parseCategory(t);var t=t.substr(t.indexOf(" ")+1),e=document.createElement("span");return e.setAttribute("class","blocklyDropdownText"),e.textContent=t,e}parseCategory(t){return t.substr(0,t.indexOf(" "))}setSelectedCategory(t){this.selectedCategory_=t}stopSounds(){pxsim.AudioContextManager.stop()}getSoundIcon(t){if(r&&r[t])return r[t][1].icon}}o.FieldMusic=s},{}],6:[function(t,e,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.FieldPorts=void 0;class i extends pxtblockly.FieldImages{constructor(t,e,o){super(t,{blocksInfo:e.blocksInfo,sort:!0,data:e.data},o),this.isFieldCustom_=!0,this.buttonClick_=function(t){t=t.target.getAttribute("data-value");this.setValue(t),Blockly.DropDownDiv.hide()},this.columns_=parseInt(e.columns)||4,this.width_=parseInt(e.width)||300,this.setText=Blockly.FieldDropdown.prototype.setText,this.updateSize_=Blockly.Field.prototype.updateSize_}trimOptions_(){}}o.FieldPorts=i},{}]},{},[1,2,3,4,5,6]);