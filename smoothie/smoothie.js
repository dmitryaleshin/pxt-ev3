!function(t){var r={extend:function(){arguments[0]=arguments[0]||{};for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[t].hasOwnProperty(e)&&("object"!=typeof arguments[t][e]||arguments[t][e]instanceof Array?arguments[0][e]=arguments[t][e]:arguments[0][e]=r.extend(arguments[0][e],arguments[t][e]));return arguments[0]},binarySearch:function(t,e){for(var i=0,s=t.length;i<s;){var a=i+s>>1;e<t[a][0]?s=a:i=1+a}return i}};function e(t){this.options=r.extend({},e.defaultOptions,t),this.clear()}function a(t){this.options=r.extend({},a.defaultChartOptions,t),this.seriesSet=[],this.currentValueRange=1,this.currentVisMinValue=0,this.lastRenderTimeMillis=0,this.mousemove=this.mousemove.bind(this),this.mouseout=this.mouseout.bind(this)}e.defaultOptions={resetBoundsInterval:3e3,resetBounds:!0},e.prototype.clear=function(){this.data=[],this.maxValue=Number.NaN,this.minValue=Number.NaN},e.prototype.resetBounds=function(){if(this.data.length){this.maxValue=this.data[0][1],this.minValue=this.data[0][1];for(var t=1;t<this.data.length;t++){var e=this.data[t][1];e>this.maxValue&&(this.maxValue=e),e<this.minValue&&(this.minValue=e)}}else this.maxValue=Number.NaN,this.minValue=Number.NaN},e.prototype.append=function(t,e,i){for(var s=this.data.length-1;0<=s&&this.data[s][0]>t;)s--;-1===s?this.data.splice(0,0,[t,e]):0<this.data.length&&this.data[s][0]===t?i?(this.data[s][1]+=e,e=this.data[s][1]):this.data[s][1]=e:s<this.data.length-1?this.data.splice(s+1,0,[t,e]):this.data.push([t,e]),this.maxValue=isNaN(this.maxValue)?e:Math.max(this.maxValue,e),this.minValue=isNaN(this.minValue)?e:Math.min(this.minValue,e)},a.defaultChartOptions={millisPerPixel:20,enableDpiScaling:!0,yMinFormatter:function(t,e){return parseFloat(t).toFixed(e)},yMaxFormatter:function(t,e){return parseFloat(t).toFixed(e)},maxValueScale:1,minValueScale:1,interpolation:"bezier",scaleSmoothing:.125,maxDataSetLength:2,scrollBackwards:!(e.prototype.dropOldData=function(t,e){for(var i=0;this.data.length-i>=e&&this.data[i+1][0]<t;)i++;0!==i&&this.data.splice(0,i)}),grid:{fillStyle:"#000000",strokeStyle:"#777777",lineWidth:1,sharpLines:!1,millisPerLine:1e3,verticalSections:2,borderVisible:!0},labels:{fillStyle:"#ffffff",disabled:!1,fontSize:10,fontFamily:"monospace",precision:2},horizontalLines:[],tooltip:!1,tooltipLine:{lineWidth:1,strokeStyle:"#BBBBBB"},tooltipFormatter:a.tooltipFormatter=function(t,e){for(var i=[(this.options.timestampFormatter||a.timeFormatter)(new Date(t))],s=0;s<e.length;++s)i.push('<span style="color:'+e[s].series.options.strokeStyle+'">'+this.options.yMaxFormatter(e[s].value,this.options.labels.precision)+"</span>");return i.join("<br>")},responsive:!1,limitFPS:0},a.AnimateCompatibility={requestAnimationFrame:function(t,e){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(function(){t((new Date).getTime())},16)}).call(window,t,e)},cancelAnimationFrame:function(t){return(window.cancelAnimationFrame||function(t){clearTimeout(t)}).call(window,t)}},a.defaultSeriesPresentationOptions={lineWidth:1,strokeStyle:"#ffffff"},a.prototype.addTimeSeries=function(t,e){this.seriesSet.push({timeSeries:t,options:r.extend({},a.defaultSeriesPresentationOptions,e)}),t.options.resetBounds&&0<t.options.resetBoundsInterval&&(t.resetBoundsTimerId=setInterval(function(){t.resetBounds()},t.options.resetBoundsInterval))},a.prototype.removeTimeSeries=function(t){for(var e=this.seriesSet.length,i=0;i<e;i++)if(this.seriesSet[i].timeSeries===t){this.seriesSet.splice(i,1);break}t.resetBoundsTimerId&&clearInterval(t.resetBoundsTimerId)},a.prototype.getTimeSeriesOptions=function(t){for(var e=this.seriesSet.length,i=0;i<e;i++)if(this.seriesSet[i].timeSeries===t)return this.seriesSet[i].options},a.prototype.bringToFront=function(t){for(var e=this.seriesSet.length,i=0;i<e;i++)if(this.seriesSet[i].timeSeries===t){var s=this.seriesSet.splice(i,1);this.seriesSet.push(s[0]);break}},a.prototype.streamTo=function(t,e){this.canvas=t,this.delay=e,this.start()},a.prototype.getTooltipEl=function(){var t=a.tooltipEl;return t||((t=a.tooltipEl=document.createElement("div")).className="smoothie-chart-tooltip",t.style.position="absolute",t.style.display="none",document.body.appendChild(t)),t},a.prototype.updateTooltip=function(){var t=this.getTooltipEl();if(this.mouseover&&this.options.tooltip){for(var e=this.lastRenderTimeMillis-(this.delay||0),i=(e-=e%this.options.millisPerPixel,this.options.scrollBackwards?e-this.mouseX*this.options.millisPerPixel:e-(this.canvas.offsetWidth-this.mouseX)*this.options.millisPerPixel),s=[],a=0;a<this.seriesSet.length;a++){var o=this.seriesSet[a].timeSeries,n=r.binarySearch(o.data,i);0<n&&n<o.data.length&&s.push({series:this.seriesSet[a],index:n,value:o.data[n][1]})}s.length?(t.innerHTML=this.options.tooltipFormatter.call(this,i,s),t.style.display="block"):t.style.display="none"}else t.style.display="none"},a.prototype.mousemove=function(t){this.mouseover=!0,this.mouseX=t.offsetX,this.mouseY=t.offsetY,this.mousePageX=t.pageX,this.mousePageY=t.pageY;t=this.getTooltipEl();t.style.top=Math.round(this.mousePageY)+"px",t.style.left=Math.round(this.mousePageX)+"px",this.updateTooltip()},a.prototype.mouseout=function(){this.mouseover=!1,this.mouseX=this.mouseY=-1,a.tooltipEl&&(a.tooltipEl.style.display="none")},a.prototype.resize=function(){var t,e,i=this.options.enableDpiScaling&&window?window.devicePixelRatio:1;this.options.responsive?(t=this.canvas.offsetWidth,e=this.canvas.offsetHeight,t!==this.lastWidth&&(this.lastWidth=t,this.canvas.setAttribute("width",t.toString())),e!==this.lastHeight&&(this.lastHeight=e,this.canvas.setAttribute("height",e.toString()))):1!==i&&(t=parseInt(this.canvas.getAttribute("width")),e=parseInt(this.canvas.getAttribute("height")),this.originalWidth&&Math.floor(this.originalWidth*i)===t||(this.originalWidth=t,this.canvas.setAttribute("width",Math.floor(t*i).toString()),this.canvas.style.width=t+"px",this.canvas.getContext("2d").scale(i,i)),this.originalHeight&&Math.floor(this.originalHeight*i)===e||(this.originalHeight=e,this.canvas.setAttribute("height",Math.floor(e*i).toString()),this.canvas.style.height=e+"px",this.canvas.getContext("2d").scale(i,i)))},a.prototype.start=function(){var t;this.frame||(this.canvas.addEventListener("mousemove",this.mousemove),this.canvas.addEventListener("mouseout",this.mouseout),(t=function(){this.frame=a.AnimateCompatibility.requestAnimationFrame(function(){this.render(),t()}.bind(this))}.bind(this))())},a.prototype.stop=function(){this.frame&&(a.AnimateCompatibility.cancelAnimationFrame(this.frame),delete this.frame,this.canvas.removeEventListener("mousemove",this.mousemove),this.canvas.removeEventListener("mouseout",this.mouseout))},a.prototype.updateValueRange=function(){for(var t,e,i=this.options,s=Number.NaN,a=Number.NaN,o=0;o<this.seriesSet.length;o++){var n=this.seriesSet[o].timeSeries;isNaN(n.maxValue)||(s=isNaN(s)?n.maxValue:Math.max(s,n.maxValue)),isNaN(n.minValue)||(a=isNaN(a)?n.minValue:Math.min(a,n.minValue))}null!=i.maxValue?s=i.maxValue:s*=i.maxValueScale,null!=i.minValue?a=i.minValue:a-=Math.abs(a*i.minValueScale-a),this.options.yRangeFunction&&(a=(t=this.options.yRangeFunction({min:a,max:s})).min,s=t.max),isNaN(s)||isNaN(a)||(t=s-a-this.currentValueRange,e=a-this.currentVisMinValue,this.isAnimatingScale=.1<Math.abs(t)||.1<Math.abs(e),this.currentValueRange+=i.scaleSmoothing*t,this.currentVisMinValue+=i.scaleSmoothing*e),this.valueRange={min:a,max:s}},a.prototype.render=function(t,e){var i=(new Date).getTime();if(!(0<this.options.limitFPS&&i-this.lastRenderTimeMillis<1e3/this.options.limitFPS)){if(!this.isAnimatingScale){var s=Math.min(1e3/6,this.options.millisPerPixel);if(i-this.lastRenderTimeMillis<s)return}this.resize(),this.updateTooltip(),this.lastRenderTimeMillis=i,t=t||this.canvas,e=e||i-(this.delay||0),e-=e%this.options.millisPerPixel;function a(t){return n.scrollBackwards?Math.round((e-t)/n.millisPerPixel):Math.round(r.width-(e-t)/n.millisPerPixel)}var o=t.getContext("2d"),n=this.options,r={top:0,left:0,width:t.clientWidth,height:t.clientHeight},l=e-r.width*n.millisPerPixel,h=function(t){t-=this.currentVisMinValue;return 0===this.currentValueRange?r.height:r.height-Math.round(t/this.currentValueRange*r.height)}.bind(this);if(this.updateValueRange(),o.font=n.labels.fontSize+"px "+n.labels.fontFamily,o.save(),o.translate(r.left,r.top),o.beginPath(),o.rect(0,0,r.width,r.height),o.clip(),o.save(),o.fillStyle=n.grid.fillStyle,o.clearRect(0,0,r.width,r.height),o.fillRect(0,0,r.width,r.height),o.restore(),o.save(),o.lineWidth=n.grid.lineWidth,o.strokeStyle=n.grid.strokeStyle,0<n.grid.millisPerLine){o.beginPath();for(var u=e-e%n.grid.millisPerLine;l<=u;u-=n.grid.millisPerLine){var m=a(u);n.grid.sharpLines&&(m-=.5),o.moveTo(m,0),o.lineTo(m,r.height)}o.stroke(),o.closePath()}for(var d=1;d<n.grid.verticalSections;d++){var p=Math.round(d*r.height/n.grid.verticalSections);n.grid.sharpLines&&(p-=.5),o.beginPath(),o.moveTo(0,p),o.lineTo(r.width,p),o.stroke(),o.closePath()}if(n.grid.borderVisible&&(o.beginPath(),o.strokeRect(0,0,r.width,r.height),o.closePath()),o.restore(),n.horizontalLines&&n.horizontalLines.length)for(var c=0;c<n.horizontalLines.length;c++){var f=n.horizontalLines[c],g=Math.round(h(f.value))-.5;o.strokeStyle=f.color||"#ffffff",o.lineWidth=f.lineWidth||1,o.beginPath(),o.moveTo(0,g),o.lineTo(r.width,g),o.stroke(),o.closePath()}for(var v,S=0;S<this.seriesSet.length;S++){o.save();for(var y=this.seriesSet[S].timeSeries,b=y.data,x=this.seriesSet[S].options,w=(y.dropOldData(l,n.maxDataSetLength),o.lineWidth=x.lineWidth,o.strokeStyle=x.strokeStyle,o.beginPath(),0),T=0,P=0,V=0;V<b.length&&1!==b.length;V++){var N=a(b[V][0]),M=h(b[V][1]);if(0===V)o.moveTo(w=N,M);else switch(n.interpolation){case"linear":case"line":o.lineTo(N,M);break;case"bezier":default:o.bezierCurveTo(Math.round((T+N)/2),P,Math.round(T+N)/2,M,N,M);break;case"step":o.lineTo(N,P),o.lineTo(N,M)}T=N,P=M}1<b.length&&(x.fillStyle&&(o.lineTo(r.width+x.lineWidth+1,P),o.lineTo(r.width+x.lineWidth+1,r.height+x.lineWidth+1),o.lineTo(w,r.height+x.lineWidth),o.fillStyle=x.fillStyle,o.fill()),x.strokeStyle&&"none"!==x.strokeStyle&&o.stroke(),o.closePath()),o.restore()}if(n.tooltip&&0<=this.mouseX&&(o.lineWidth=n.tooltipLine.lineWidth,o.strokeStyle=n.tooltipLine.strokeStyle,o.beginPath(),o.moveTo(this.mouseX,0),o.lineTo(this.mouseX,r.height),o.closePath(),o.stroke(),this.updateTooltip()),n.labels.disabled||isNaN(this.valueRange.min)||isNaN(this.valueRange.max)||(s=n.yMaxFormatter(this.valueRange.max,n.labels.precision),v=n.yMinFormatter(this.valueRange.min,n.labels.precision),i=n.scrollBackwards?0:r.width-o.measureText(s).width-5,t=n.scrollBackwards?0:r.width-o.measureText(v).width-5,o.fillStyle=n.labels.fillStyle,o.fillText(s,i,n.labels.fontSize),o.fillText(v,t,r.height-2)),n.timestampFormatter&&0<n.grid.millisPerLine)for(var k=n.scrollBackwards?o.measureText(v).width:r.width-o.measureText(v).width+4,u=e-e%n.grid.millisPerLine;l<=u;u-=n.grid.millisPerLine){var F,R,m=a(u);(!n.scrollBackwards&&m<k||n.scrollBackwards&&k<m)&&(F=new Date(u),F=n.timestampFormatter(F),R=o.measureText(F).width,k=n.scrollBackwards?m+R+2:m-R-2,o.fillStyle=n.labels.fillStyle,n.scrollBackwards?o.fillText(F,m,r.height-2):o.fillText(F,m-R,r.height-2))}o.restore()}},a.timeFormatter=function(t){function e(t){return(t<10?"0":"")+t}return e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())},t.TimeSeries=e,t.SmoothieChart=a}("undefined"==typeof exports?this:exports);